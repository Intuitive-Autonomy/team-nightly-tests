#!/bin/bash
# Python Test Runner Template
# Copy this to your repository root and customize as needed

set -e  # Exit on error

echo "=== Python Test Runner ==="

# Parse test type argument (smoke or comprehensive)
TEST_TYPE="${1:-smoke}"
echo "Test type: $TEST_TYPE"

# Install dependencies
echo "Installing dependencies..."
if [ -f "requirements.txt" ]; then
    pip install -r requirements.txt
fi
pip install pytest pytest-cov flake8

# Run linting (comprehensive tests only)
if [ "$TEST_TYPE" = "comprehensive" ]; then
    echo "Running linting..."
    flake8 src/ --count --select=E9,F63,F7,F82 --show-source --statistics
    flake8 src/ --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
fi

# Run tests
echo "Running tests..."
if [ "$TEST_TYPE" = "smoke" ]; then
    # Quick smoke tests only
    pytest tests/ -v -m "not slow" --tb=short || pytest tests/ -v -k "test_import or test_basic" --tb=short
else
    # Full test suite with coverage
    pytest tests/ -v --cov=src --cov-report=term-missing
fi

echo "âœ“ Tests passed!"
